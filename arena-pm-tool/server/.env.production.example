# ===========================================
# TODORIO SERVER - PRODUCTION CONFIG
# ===========================================
# Use these settings for Vercel production deployment
# Set these as Environment Variables in Vercel Dashboard
# NEVER commit actual values to Git

# ===========================================
# REQUIRED ENVIRONMENT VARIABLES
# ===========================================

# Server Mode (auto-set by Vercel, but good to be explicit)
NODE_ENV=production

# Database - Supabase PostgreSQL Connection
# Get from: Supabase Dashboard > Settings > Database > Connection string > URI
# Format: postgresql://postgres.[PROJECT_REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres
DATABASE_URL=postgresql://postgres.[PROJECT_REF]:[YOUR_DB_PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres?sslmode=require

# JWT Authentication
# Generate with: openssl rand -base64 64 | tr -d '\n'
# MUST be at least 64 characters of random data
JWT_SECRET=GENERATE_64_PLUS_RANDOM_CHARACTERS_HERE
JWT_EXPIRES_IN=7d

# CORS - Allowed Origins (your Vercel client URLs)
# Include both production and preview domains
# NO trailing slashes, comma-separated, no spaces
ALLOWED_ORIGINS=https://your-client.vercel.app,https://your-client-git-main-username.vercel.app

# Vercel Cron Job Authentication
# Generate with: openssl rand -base64 32 | tr -d '\n'
# MUST match the value in Vercel's cron configuration
CRON_SECRET=GENERATE_32_PLUS_RANDOM_CHARACTERS_HERE

# ===========================================
# OPTIONAL ENVIRONMENT VARIABLES
# ===========================================

# Email Notifications (Resend - required for reminder emails)
# Get your API key at: https://resend.com/api-keys
RESEND_API_KEY=re_your_api_key_here
EMAIL_FROM=noreply@yourdomain.com
EMAIL_FROM_NAME=Todoria

# Supabase Service Role (only if using Supabase client library)
# Get from: Supabase Dashboard > Settings > API > service_role key
# WARNING: This key bypasses RLS - NEVER expose to client
SUPABASE_URL=https://[PROJECT_REF].supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJ_YOUR_SERVICE_ROLE_KEY_NEVER_EXPOSE

# Rate Limiting (optional overrides)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# Proxy Trust (Vercel runs behind a proxy)
TRUST_PROXY=true

# Holiday API for due date calculations (optional)
ABSTRACT_API_KEY=your_abstract_api_key

# Error Tracking (Sentry - recommended for production)
# Get your DSN from: https://sentry.io → Project Settings → Client Keys (DSN)
SENTRY_DSN=https://your-public-key@o0.ingest.sentry.io/0

# ===========================================
# VERCEL-SPECIFIC NOTES
# ===========================================
#
# Auto-set by Vercel (DO NOT configure manually):
# - VERCEL=1
# - VERCEL_ENV=production|preview|development
# - VERCEL_URL=your-deployment-url.vercel.app
#
# Configure in Vercel Dashboard:
# 1. Go to Project > Settings > Environment Variables
# 2. Add each variable above
# 3. Set appropriate environments (Production, Preview, Development)
# 4. Redeploy for changes to take effect
#
# ===========================================
# SECURITY CHECKLIST
# ===========================================
# [ ] JWT_SECRET is 64+ random characters
# [ ] DATABASE_URL uses ?sslmode=require
# [ ] ALLOWED_ORIGINS does not include wildcard (*)
# [ ] SUPABASE_SERVICE_ROLE_KEY is server-side only
# [ ] RESEND_API_KEY is set and valid
# [ ] CRON_SECRET is unique and random
# [ ] No secrets are logged or exposed in error messages
